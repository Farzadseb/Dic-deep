<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <title>Dic-deep - Ø¯ÛŒÚ©Ø´Ù†Ø±ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯</title>
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ... */
        
        .audio-controls {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            align-items: center;
        }
        
        .audio-btn {
            background: #4361ee;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .audio-btn:hover {
            background: #3a0ca3;
        }
        
        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9em;
            color: #666;
        }
        
        .tts-active {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“š Dic-deep</h1>
        
        <!-- Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ ØµÙˆØªÛŒ Ú©Ù„ÛŒ -->
        <div class="audio-controls" style="justify-content: center; margin: 20px 0;">
            <button class="audio-btn" onclick="toggleAutoPlay()" id="autoplay-toggle">
                <span id="autoplay-icon">ğŸ”Š</span>
                <span id="autoplay-text">Ù¾Ø®Ø´ Ø®ÙˆØ¯Ú©Ø§Ø±: Ø±ÙˆØ´Ù†</span>
            </button>
            
            <div class="speed-control">
                <span>Ø³Ø±Ø¹Øª:</span>
                <span id="speed-display">0.7x</span>
                <button onclick="changeSpeed(-0.1)">â–</button>
                <button onclick="changeSpeed(0.1)">â•</button>
            </div>
        </div>
        
        <!-- Ø¬Ø³ØªØ¬Ùˆ Ùˆ Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬ (Ù…Ø§Ù†Ù†Ø¯ Ù‚Ø¨Ù„) -->
        <div id="search-results">
            <!-- Ù†ØªØ§ÛŒØ¬ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
        </div>
        
        <!-- Ù†Ù…ÙˆÙ†Ù‡ Ù†Ù…Ø§ÛŒØ´ ÛŒÚ© Ù„ØºØª Ø¨Ø§ ØµÙˆØª -->
        <div id="word-display-template" style="display: none;">
            <div class="word-card">
                <div class="word-header">
                    <h2>
                        <span class="word-text">{word}</span>
                        <small>{phonetic}</small>
                    </h2>
                    <button class="audio-btn" onclick="playWordAudio('{word}')" id="play-{word}">
                        ğŸ”Š Ù¾Ø®Ø´ Ù„ØºØª
                    </button>
                </div>
                
                <div class="meaning">
                    <strong>Ù…Ø¹Ù†ÛŒ:</strong> {meaning}
                </div>
                
                <div class="examples">
                    <strong>Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§:</strong>
                    <ul>
                        {examples}
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ğŸ”§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØµÙˆØª
        const audioSettings = {
            autoPlay: true,      // Ù¾Ø®Ø´ Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ù†Ú¯Ø§Ù… Ù¾ÛŒØ¯Ø§ Ø´Ø¯Ù† Ù„ØºØª
            speed: 0.7,          // Ø³Ø±Ø¹Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶
            voice: 'en-US',      // ØµØ¯Ø§ÛŒ Ø¢Ù…Ø±ÛŒÚ©Ø§ÛŒÛŒ
            volume: 1.0          // Ø­Ø¬Ù… ØµØ¯Ø§
        };
        
        // ğŸ”Š Ø³ÛŒØ³ØªÙ… TTS
        class TTSSystem {
            constructor() {
                this.synth = window.speechSynthesis;
                this.currentUtterance = null;
                this.isSpeaking = false;
            }
            
            // Ù¾Ø®Ø´ ÛŒÚ© Ù…ØªÙ† Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
            speak(text, callback = null) {
                if (!this.synth) {
                    console.warn('Ù…Ø±ÙˆØ±Ú¯Ø± Ø§Ø² TTS Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯');
                    if (callback) callback(false);
                    return;
                }
                
                // Ù…ØªÙˆÙ‚Ù Ú©Ø±Ø¯Ù† ØµÙˆØª Ù‚Ø¨Ù„ÛŒ Ø§Ú¯Ø± Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´ Ø§Ø³Øª
                this.stop();
                
                // Ø§ÛŒØ¬Ø§Ø¯ utterance Ø¬Ø¯ÛŒØ¯
                const utterance = new SpeechSynthesisUtterance(text);
                
                // ØªÙ†Ø¸ÛŒÙ…Ø§Øª
                utterance.rate = audioSettings.speed;
                utterance.lang = audioSettings.voice;
                utterance.volume = audioSettings.volume;
                utterance.pitch = 1;
                
                // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§
                utterance.onstart = () => {
                    this.isSpeaking = true;
                    console.log(`ğŸ”Š Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´: "${text}"`);
                };
                
                utterance.onend = () => {
                    this.isSpeaking = false;
                    if (callback) callback(true);
                };
                
                utterance.onerror = (error) => {
                    this.isSpeaking = false;
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø®Ø´ ØµÙˆØª:', error);
                    if (callback) callback(false);
                };
                
                // Ø´Ø±ÙˆØ¹ Ù¾Ø®Ø´
                this.currentUtterance = utterance;
                this.synth.speak(utterance);
            }
            
            // ØªÙˆÙ‚Ù ØµÙˆØª
            stop() {
                if (this.synth && this.isSpeaking) {
                    this.synth.cancel();
                    this.isSpeaking = false;
                }
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª
            isAvailable() {
                return !!window.speechSynthesis;
            }
            
            // Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒØ³Øª ØµØ¯Ø§Ù‡Ø§
            getVoices() {
                return new Promise((resolve) => {
                    const voices = this.synth.getVoices();
                    if (voices.length > 0) {
                        resolve(voices);
                    } else {
                        this.synth.onvoiceschanged = () => {
                            resolve(this.synth.getVoices());
                        };
                    }
                });
            }
        }
        
        // Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆÙ†Ù‡ TTS
        const tts = new TTSSystem();
        
        // ğŸ“ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ (Ù…Ø«Ù„ Ù‚Ø¨Ù„)
        const dictionary = {
            "be": {
                meaning: "Ø¨ÙˆØ¯Ù†",
                examples: [
                    "I am here.",
                    "Be happy."
                ]
            },
            "have": {
                meaning: "Ø¯Ø§Ø´ØªÙ†",
                examples: [
                    "I have a book.",
                    "She has a cat."
                ]
            }
        };
        
        // ğŸ¯ Ø¬Ø³ØªØ¬ÙˆÛŒ Ù„ØºØª Ø¨Ø§ Ù¾Ø®Ø´ Ø®ÙˆØ¯Ú©Ø§Ø± ØµÙˆØª
        async function searchWord() {
            const input = document.getElementById('searchInput');
            const word = input.value.toLowerCase().trim();
            const resultsDiv = document.getElementById('searchResults');
            
            if (!word) {
                resultsDiv.innerHTML = '<p>Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ù„ØºØª ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</p>';
                return;
            }
            
            if (dictionary[word]) {
                const wordData = dictionary[word];
                
                // Ø§ÛŒØ¬Ø§Ø¯ HTML Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù„ØºØª
                let examplesHTML = '';
                wordData.examples.forEach((example, index) => {
                    examplesHTML += `
                        <li>
                            ${example}
                            <button class="audio-btn small" onclick="playExampleAudio('${example}', ${index})">
                                ğŸ”Š
                            </button>
                        </li>
                    `;
                });
                
                const template = document.getElementById('word-display-template').innerHTML;
                const html = template
                    .replace(/{word}/g, word)
                    .replace('{phonetic}', '')
                    .replace('{meaning}', wordData.meaning)
                    .replace('{examples}', examplesHTML);
                
                resultsDiv.innerHTML = html;
                
                // ğŸ”¥ Ù¾Ø®Ø´ Ø®ÙˆØ¯Ú©Ø§Ø± ØµÙˆØª Ù„ØºØª (Ø§Ú¯Ø± ÙØ¹Ø§Ù„ Ø¨Ø§Ø´Ø¯)
                if (audioSettings.autoPlay) {
                    // Ú©Ù…ÛŒ ØªØ£Ø®ÛŒØ± Ø¨Ø±Ø§ÛŒ UX Ø¨Ù‡ØªØ±
                    setTimeout(() => {
                        playWordAudio(word);
                        console.log(`âœ… Ù¾Ø®Ø´ Ø®ÙˆØ¯Ú©Ø§Ø± Ù„ØºØª: "${word}"`);
                    }, 300);
                }
                
                // Ù‡Ø§ÛŒÙ„Ø§ÛŒØª Ø¯Ú©Ù…Ù‡ Ù¾Ø®Ø´
                highlightPlayButton(word);
                
            } else {
                resultsDiv.innerHTML = `
                    <div class="error">
                        <p>Ù„ØºØª "${word}" ÛŒØ§ÙØª Ù†Ø´Ø¯</p>
                        <p>Ù„ØºØ§Øª Ù…ÙˆØ¬ÙˆØ¯: ${Object.keys(dictionary).join(', ')}</p>
                    </div>
                `;
            }
        }
        
        // ğŸ”Š Ù¾Ø®Ø´ ØµÙˆØª Ù„ØºØª
        function playWordAudio(word) {
            if (!tts.isAvailable()) {
                alert('Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² Ù‚Ø§Ø¨Ù„ÛŒØª Text-to-Speech Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯. Ù„Ø·ÙØ§Ù‹ Ø§Ø² Chrome ÛŒØ§ Edge Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.');
                return;
            }
            
            // Ø¯Ú©Ù…Ù‡ Ù¾Ø®Ø´ Ø±Ø§ ÙØ¹Ø§Ù„ Ù†Ø´Ø§Ù† Ø¨Ø¯Ù‡
            const buttonId = `play-${word}`;
            const button = document.getElementById(buttonId);
            if (button) {
                button.innerHTML = 'â¸ Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´...';
                button.classList.add('tts-active');
            }
            
            // Ù¾Ø®Ø´ ØµÙˆØª
            tts.speak(word, (success) => {
                if (button) {
                    button.innerHTML = 'ğŸ”Š Ù¾Ø®Ø´ Ù…Ø¬Ø¯Ø¯';
                    button.classList.remove('tts-active');
                }
            });
        }
        
        // ğŸ”Š Ù¾Ø®Ø´ ØµÙˆØª Ù…Ø«Ø§Ù„
        function playExampleAudio(example, index) {
            // Ø­Ø°Ù ØªØ±Ø¬Ù…Ù‡ ÙØ§Ø±Ø³ÛŒ (Ø§Ú¯Ø± ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯)
            const englishOnly = example.split(' - ')[0];
            
            tts.speak(englishOnly, (success) => {
                console.log(`Ù…Ø«Ø§Ù„ ${index + 1} Ù¾Ø®Ø´ ${success ? 'Ø´Ø¯' : 'Ù†Ø´Ø¯'}`);
            });
        }
        
        // ğŸ›ï¸ Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ ØµÙˆØªÛŒ
        function toggleAutoPlay() {
            audioSettings.autoPlay = !audioSettings.autoPlay;
            
            const icon = document.getElementById('autoplay-icon');
            const text = document.getElementById('autoplay-text');
            const button = document.getElementById('autoplay-toggle');
            
            if (audioSettings.autoPlay) {
                icon.textContent = 'ğŸ”Š';
                text.textContent = 'Ù¾Ø®Ø´ Ø®ÙˆØ¯Ú©Ø§Ø±: Ø±ÙˆØ´Ù†';
                button.style.background = '#4361ee';
            } else {
                icon.textContent = 'ğŸ”‡';
                text.textContent = 'Ù¾Ø®Ø´ Ø®ÙˆØ¯Ú©Ø§Ø±: Ø®Ø§Ù…ÙˆØ´';
                button.style.background = '#666';
            }
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
            localStorage.setItem('dicdeep-autoplay', audioSettings.autoPlay);
            
            console.log(`Ù¾Ø®Ø´ Ø®ÙˆØ¯Ú©Ø§Ø±: ${audioSettings.autoPlay ? 'Ø±ÙˆØ´Ù†' : 'Ø®Ø§Ù…ÙˆØ´'}`);
        }
        
        function changeSpeed(delta) {
            audioSettings.speed = Math.max(0.5, Math.min(1.5, audioSettings.speed + delta));
            document.getElementById('speed-display').textContent = audioSettings.speed.toFixed(1) + 'x';
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
            localStorage.setItem('dicdeep-speed', audioSettings.speed);
            
            console.log(`Ø³Ø±Ø¹Øª Ø¬Ø¯ÛŒØ¯: ${audioSettings.speed}`);
        }
        
        function highlightPlayButton(word) {
            // Ù‡Ù…Ù‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ù‡ Ø­Ø§Ù„Øª Ø¹Ø§Ø¯ÛŒ Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†
            document.querySelectorAll('.audio-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Ø¯Ú©Ù…Ù‡ Ø§ÛŒÙ† Ù„ØºØª Ø±Ø§ ÙØ¹Ø§Ù„ Ú©Ù†
            const button = document.getElementById(`play-${word}`);
            if (button) {
                button.classList.add('active');
            }
        }
        
        // ğŸ“± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
        function loadSettings() {
            const savedAutoPlay = localStorage.getItem('dicdeep-autoplay');
            const savedSpeed = localStorage.getItem('dicdeep-speed');
            
            if (savedAutoPlay !== null) {
                audioSettings.autoPlay = savedAutoPlay === 'true';
            }
            
            if (savedSpeed !== null) {
                audioSettings.speed = parseFloat(savedSpeed);
            }
            
            // Ø¢Ù¾Ø¯ÛŒØª Ù†Ù…Ø§ÛŒØ´
            document.getElementById('speed-display').textContent = audioSettings.speed.toFixed(1) + 'x';
            
            if (!audioSettings.autoPlay) {
                toggleAutoPlay(); // Ø¨Ø±Ø§ÛŒ Ø¢Ù¾Ø¯ÛŒØª Ù†Ù…Ø§ÛŒØ´
            }
        }
        
        // ğŸš€ Ø´Ø±ÙˆØ¹
        window.addEventListener('DOMContentLoaded', () => {
            loadSettings();
            
            // ØªØ³Øª TSS
            if (!tts.isAvailable()) {
                console.warn('âš ï¸ TTS Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª');
                document.getElementById('autoplay-toggle').disabled = true;
                document.getElementById('autoplay-toggle').title = 'Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² TTS Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯';
            }
            
            // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯
            console.log('ğŸ§ Ø³ÛŒØ³ØªÙ… TTS Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª!');
            console.log('âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª:', audioSettings);
        });
    </script>
</body>
</html>
