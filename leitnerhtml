<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙ…Ø±ÛŒÙ† Ù„Ø§ÛŒØªÙ†Ø± - Dic-deep</title>
    
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #f72585;
            --success: #4cc9f0;
            --warning: #f8961e;
            --dark: #1a1a2e;
            --light: #f8f9fa;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Vazirmatn', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .back-btn {
            position: absolute;
            right: 30px;
            top: 30px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .boxes-container {
            display: flex;
            justify-content: space-between;
            margin: 40px 0;
            gap: 15px;
        }
        
        .leitner-box {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .leitner-box.active {
            border-color: var(--accent);
            background: rgba(247, 37, 133, 0.2);
            transform: translateY(-5px);
        }
        
        .box-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .box-count {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--success);
        }
        
        .box-label {
            font-size: 0.9rem;
            margin-top: 5px;
            opacity: 0.8;
        }
        
        .practice-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 20px;
            margin: 30px 0;
        }
        
        .word-card {
            background: rgba(255, 255, 255, 0.15);
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 20px;
            border-left: 5px solid var(--primary);
        }
        
        .word-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .word-text {
            font-size: 2.2rem;
            font-weight: bold;
        }
        
        .word-meaning {
            font-size: 1.5rem;
            opacity: 0.9;
            margin-top: 5px;
        }
        
        .answer-buttons {
            display: flex;
            gap: 20px;
            margin-top: 25px;
            justify-content: center;
        }
        
        .answer-btn {
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            min-width: 200px;
            justify-content: center;
        }
        
        .correct-btn {
            background: linear-gradient(to right, #4CAF50, #2E7D32);
            color: white;
        }
        
        .wrong-btn {
            background: linear-gradient(to right, #F44336, #C62828);
            color: white;
        }
        
        .answer-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--success), var(--accent));
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        .completed-message {
            text-align: center;
            padding: 40px;
            background: rgba(76, 201, 240, 0.2);
            border-radius: 20px;
            margin: 30px 0;
            border: 2px solid var(--success);
        }
        
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            margin: 10px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn:hover {
            background: var(--secondary);
            transform: translateY(-3px);
        }
        
        @media (max-width: 768px) {
            .boxes-container {
                flex-direction: column;
            }
            
            .answer-buttons {
                flex-direction: column;
            }
            
            .answer-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-btn">
        <i class="fas fa-arrow-right"></i>
        Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¯ÛŒÚ©Ø´Ù†Ø±ÛŒ
    </a>
    
    <div class="container">
        <header>
            <h1>
                <i class="fas fa-brain"></i>
                ØªÙ…Ø±ÛŒÙ† Ù„Ø§ÛŒØªÙ†Ø±
            </h1>
            <p>Ø³ÛŒØ³ØªÙ… Ù‡ÙˆØ´Ù…Ù†Ø¯ ØªÚ©Ø±Ø§Ø± ÙØ§ØµÙ„Ù‡â€ŒØ¯Ø§Ø± Ø¨Ø±Ø§ÛŒ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ø¹Ù…ÛŒÙ‚ Ù„ØºØ§Øª</p>
        </header>
        
        <!-- Ø¢Ù…Ø§Ø± -->
        <div id="stats-container" class="stats-container">
            <!-- Ø¢Ù…Ø§Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
        </div>
        
        <!-- Ø¨Ø§Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ù„Ø§ÛŒØªÙ†Ø± -->
        <div class="boxes-container" id="leitner-boxes">
            <!-- Ø¨Ø§Ú©Ø³â€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
        </div>
        
        <!-- Ø¨Ø®Ø´ ØªÙ…Ø±ÛŒÙ† -->
        <div class="practice-section" id="practice-section">
            <div id="practice-content">
                <!-- Ù…Ø­ØªÙˆØ§ÛŒ ØªÙ…Ø±ÛŒÙ† Ø§ÛŒÙ†Ø¬Ø§ Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <div id="progress-text">Û° Ø§Ø² Û±Û° Ù„ØºØª</div>
            </div>
        </div>
        
        <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ÛŒ -->
        <div style="text-align: center; margin-top: 40px;">
            <button class="btn" onclick="startPractice()" id="start-btn">
                <i class="fas fa-play"></i>
                Ø´Ø±ÙˆØ¹ ØªÙ…Ø±ÛŒÙ† Ø§Ù…Ø±ÙˆØ²
            </button>
            
            <button class="btn" onclick="addTestWords()" style="background: var(--accent);">
                <i class="fas fa-plus"></i>
                Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù„ØºØª ØªØ³Øª
            </button>
            
            <button class="btn" onclick="resetProgress()" style="background: var(--warning);">
                <i class="fas fa-redo"></i>
                Ø±ÛŒØ³Øª Ù¾ÛŒØ´Ø±ÙØª
            </button>
        </div>
    </div>

    <!-- Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ -->
    <script src="js/leitner.js"></script>
    <script src="js/dictionary.js"></script>
    <script src="js/tts-system.js"></script>
    
    <script>
        // ğŸ¯ Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ ØªÙ…Ø±ÛŒÙ†
        let currentPractice = [];
        let currentIndex = 0;
        let correctCount = 0;
        
        // ğŸ“Š Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ù…Ø§Ø±
        function loadStats() {
            const stats = leitnerSystem.getUserStats('default') || {
                totalWords: 0,
                mastered: 0,
                masteryPercent: 0,
                todayReviewCount: 0,
                dailyGoal: 10,
                streak: 0
            };
            
            // Ù†Ù…Ø§ÛŒØ´ Ø¢Ù…Ø§Ø±
            document.getElementById('stats-container').innerHTML = `
                <div class="stat-card">
                    <div class="stat-label">Ù„ØºØ§Øª Ú©Ù„</div>
                    <div class="stat-value">${stats.totalWords}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ØªØ³Ù„Ø· ÛŒØ§ÙØªÙ‡</div>
                    <div class="stat-value">${stats.mastered}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Ø¯Ø±ØµØ¯ ØªØ³Ù„Ø·</div>
                    <div class="stat-value">${stats.masteryPercent}%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Streak</div>
                    <div class="stat-value">${stats.streek} Ø±ÙˆØ²</div>
                </div>
            `;
            
            // Ù†Ù…Ø§ÛŒØ´ Ø¨Ø§Ú©Ø³â€ŒÙ‡Ø§
            const distribution = leitnerSystem.getBoxDistribution('default');
            const boxNames = ['Ø±ÙˆØ²Ø§Ù†Ù‡', 'Û² Ø±ÙˆØ²Ù‡', 'Û´ Ø±ÙˆØ²Ù‡', 'Ù‡ÙØªÚ¯ÛŒ', 'Ù…Ø§Ù‡Ø§Ù†Ù‡'];
            
            let boxesHTML = '';
            for (let i = 1; i <= 5; i++) {
                const count = distribution[i] || 0;
                const isActive = count > 0;
                
                boxesHTML += `
                    <div class="leitner-box ${isActive ? 'active' : ''}">
                        <div class="box-number">${i}</div>
                        <div class="box-count">${count}</div>
                        <div class="box-label">${boxNames[i-1]}</div>
                    </div>
                `;
            }
            
            document.getElementById('leitner-boxes').innerHTML = boxesHTML;
            
            // Ø¢Ù¾Ø¯ÛŒØª Ø¨Ø®Ø´ ØªÙ…Ø±ÛŒÙ†
            if (stats.todayReviewCount > 0) {
                document.getElementById('practice-content').innerHTML = `
                    <div style="text-align: center; padding: 30px;">
                        <h2><i class="fas fa-calendar-check"></i> Ø§Ù…Ø±ÙˆØ² ${stats.todayReviewCount} Ù„ØºØª Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ± Ø¯Ø§Ø±ÛŒØ¯</h2>
                        <p style="margin-top: 15px; opacity: 0.9;">
                            Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ "Ø´Ø±ÙˆØ¹ ØªÙ…Ø±ÛŒÙ† Ø§Ù…Ø±ÙˆØ²" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
                        </p>
                    </div>
                `;
            } else {
                document.getElementById('practice-content').innerHTML = `
                    <div style="text-align: center; padding: 30px;">
                        <h2><i class="fas fa-check-circle" style="color: #4CAF50;"></i> Ø¢ÙØ±ÛŒÙ†!</h2>
                        <p style="margin-top: 15px; font-size: 1.2rem;">
                            Ø§Ù…Ø±ÙˆØ² Ù„ØºØªÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ± Ù†Ø¯Ø§Ø±ÛŒØ¯. Ù‡Ù…Ù‡ Ù„ØºØ§Øª Ø¨Ù‡ Ù…ÙˆÙ‚Ø¹ Ù…Ø±ÙˆØ± Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯!
                        </p>
                        <p style="margin-top: 10px; opacity: 0.8;">
                            Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù„ØºØ§Øª Ø¬Ø¯ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ ÛŒØ§ ÙØ±Ø¯Ø§ Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ú©Ù†ÛŒØ¯.
                        </p>
                    </div>
                `;
                document.getElementById('start-btn').disabled = true;
                document.getElementById('start-btn').style.opacity = '0.5';
            }
        }
        
        // ğŸ¯ Ø´Ø±ÙˆØ¹ ØªÙ…Ø±ÛŒÙ†
        function startPractice() {
            currentPractice = leitnerSystem.getTodayReview('default');
            currentIndex = 0;
            correctCount = 0;
            
            if (currentPractice.length === 0) {
                alert('Ø§Ù…Ø±ÙˆØ² Ù„ØºØªÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ± Ù†Ø¯Ø§Ø±ÛŒØ¯!');
                return;
            }
            
            document.getElementById('start-btn').style.display = 'none';
            showNextWord();
        }
        
        // ğŸ”„ Ù†Ù…Ø§ÛŒØ´ Ù„ØºØª Ø¨Ø¹Ø¯ÛŒ
        function showNextWord() {
            if (currentIndex >= currentPractice.length) {
                finishPractice();
                return;
            }
            
            const wordData = currentPractice[currentIndex];
            const wordInfo = dictionary[wordData.word];
            
            if (!wordInfo) {
                currentIndex++;
                showNextWord();
                return;
            }
            
            // Ø¢Ù¾Ø¯ÛŒØª Ù¾ÛŒØ´Ø±ÙØª
            const progressPercent = (currentIndex / currentPractice.length) * 100;
            document.getElementById('progress-fill').style.width = `${progressPercent}%`;
            document.getElementById('progress-text').textContent = 
                `${currentIndex} Ø§Ø² ${currentPractice.length} Ù„ØºØª`;
            
            // Ù†Ù…Ø§ÛŒØ´ Ù„ØºØª
            document.getElementById('practice-content').innerHTML = `
                <div class="word-card">
                    <div class="word-header">
                        <div>
                            <div class="word-text">${wordData.word}</div>
                            <div class="word-meaning" id="word-meaning" style="display: none;">
                                ${wordInfo.meaning}
                            </div>
                        </div>
                        <button class="btn" onclick="playAudio('${wordData.word}')" style="background: var(--success);">
                            <i class="fas fa-volume-up"></i>
                            Ø´Ù†ÛŒØ¯Ù† ØªÙ„ÙØ¸
                        </button>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <button class="btn" onclick="showMeaning()" style="background: var(--secondary); width: 100%;">
                            <i class="fas fa-eye"></i>
                            Ù†Ù…Ø§ÛŒØ´ Ù…Ø¹Ù†ÛŒ
                        </button>
                    </div>
                    
                    <div class="answer-buttons" style="display: none;" id="answer-buttons">
                        <button class="answer-btn correct-btn" onclick="answerWord(true)">
                            <i class="fas fa-check"></i>
                            Ø¨Ù„Ø¯ Ø¨ÙˆØ¯Ù… âœ“
                        </button>
                        <button class="answer-btn wrong-btn" onclick="answerWord(false)">
                            <i class="fas fa-times"></i>
                            Ø¨Ù„Ø¯ Ù†Ø¨ÙˆØ¯Ù… âœ—
                        </button>
                    </div>
                </div>
            `;
        }
        
        // ğŸ‘ï¸ Ù†Ù…Ø§ÛŒØ´ Ù…Ø¹Ù†ÛŒ
        function showMeaning() {
            document.getElementById('word-meaning').style.display = 'block';
            document.getElementById('answer-buttons').style.display = 'flex';
        }
        
        // âœ… Ù¾Ø§Ø³Ø® Ø¯Ø§Ø¯Ù† Ø¨Ù‡ Ù„ØºØª
        function answerWord(isCorrect) {
            const wordData = currentPractice[currentIndex];
            
            // Ø«Ø¨Øª Ø¯Ø± Ø³ÛŒØ³ØªÙ… Ù„Ø§ÛŒØªÙ†Ø±
            leitnerSystem.reviewWord(wordData.word, isCorrect, 'default');
            
            if (isCorrect) {
                correctCount++;
            }
            
            // Ù„ØºØª Ø¨Ø¹Ø¯ÛŒ
            currentIndex++;
            showNextWord();
        }
        
        // ğŸ‰ Ù¾Ø§ÛŒØ§Ù† ØªÙ…Ø±ÛŒÙ†
        function finishPractice() {
            const accuracy = currentPractice.length > 0 
                ? Math.round((correctCount / currentPractice.length) * 100) 
                : 0;
            
            document.getElementById('practice-content').innerHTML = `
                <div class="completed-message">
                    <h2><i class="fas fa-trophy" style="font-size: 3rem;"></i></h2>
                    <h3 style="margin: 20px 0; font-size: 1.8rem;">ØªÙ…Ø±ÛŒÙ† Ø§Ù…Ø±ÙˆØ² Ú©Ø§Ù…Ù„ Ø´Ø¯!</h3>
                    
                    <div style="margin: 30px 0;">
                        <div style="font-size: 1.2rem; margin-bottom: 15px;">
                            <i class="fas fa-chart-bar"></i>
                            Ù†ØªØ§ÛŒØ¬ Ø´Ù…Ø§:
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; text-align: center;">
                            <div>
                                <div style="font-size: 2rem; font-weight: bold; color: var(--success);">
                                    ${correctCount}
                                </div>
                                <div style="opacity: 0.9;">Ù¾Ø§Ø³Ø® Ø¯Ø±Ø³Øª</div>
                            </div>
                            <div>
                                <div style="font-size: 2rem; font-weight: bold; color: var(--accent);">
                                    ${accuracy}%
                                </div>
                                <div style="opacity: 0.9;">Ø¯Ù‚Øª Ú©Ù„ÛŒ</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <button class="btn" onclick="loadStats(); document.getElementById('start-btn').style.display='inline-flex';">
                            <i class="fas fa-redo"></i>
                            Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¢Ù…Ø§Ø±
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('progress-fill').style.width = '100%';
            document.getElementById('progress-text').textContent = 'ØªÙ…Ø±ÛŒÙ† Ú©Ø§Ù…Ù„ Ø´Ø¯!';
        }
        
        // ğŸ”Š Ù¾Ø®Ø´ ØµÙˆØª
        function playAudio(word) {
            // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² TTS Ø³ÛŒØ³ØªÙ…
            if (window.tts && tts.speak) {
                tts.speak(word);
            }
        }
        
        // ğŸ§ª Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù„ØºØ§Øª ØªØ³Øª
        function addTestWords() {
            const testWords = ['be', 'have', 'go', 'come', 'do', 'make'];
            
            testWords.forEach(word => {
                if (dictionary[word]) {
                    leitnerSystem.addWord(word, 'default');
                }
            });
            
            alert('Û¶ Ù„ØºØª ØªØ³Øª Ø¨Ù‡ Ø³ÛŒØ³ØªÙ… Ù„Ø§ÛŒØªÙ†Ø± Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù†Ø¯!');
            loadStats();
        }
        
        // ğŸ”„ Ø±ÛŒØ³Øª Ù¾ÛŒØ´Ø±ÙØª
        function resetProgress() {
            if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù†ÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ ØªÙ…Ø§Ù… Ù¾ÛŒØ´Ø±ÙØª Ø±Ø§ Ø±ÛŒØ³Øª Ú©Ù†ÛŒØ¯ØŸ')) {
                leitnerSystem.resetProgress('default');
                loadStats();
                alert('Ù¾ÛŒØ´Ø±ÙØª Ø±ÛŒØ³Øª Ø´Ø¯!');
            }
        }
        
        // ğŸš€ Ø´Ø±ÙˆØ¹
        window.addEventListener('DOMContentLoaded', () => {
            loadStats();
            
            // ØªØ³Øª TTS
            if (!window.tts) {
                window.tts = new TTSSystem();
            }
        });
    </script>
</body>
</html>
