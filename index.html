<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FredDic Pro - Master Edition</title>
    <style>
        :root {
            --bg: #e0e0e0;
            --shd: 8px 8px 16px #bebebe, -8px -8px 16px #ffffff;
            --inner: inset 6px 6px 12px #bebebe, inset -6px -6px 12px #ffffff;
            --blue: #2d5bc0; --red: #d32f2f; --txt: #444; --label-gray: #888;
        }
        [data-theme="dark"] {
            --bg: #222; --shd: 5px 5px 10px #151515, -5px -5px 10px #2f2f2f;
            --inner: inset 4px 4px 8px #111, inset -4px -4px 8px #333; --txt: #eee;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background: var(--bg); font-family: 'Segoe UI', Tahoma, sans-serif;
            direction: rtl; color: var(--txt); overflow: hidden;
        }

        /* Ø³ÛŒØ³ØªÙ… Ø§Ø³Ù„Ø§ÛŒØ¯ ØµÙØ­Ø§Øª */
        .screen-container { position: relative; width: 100%; height: 100%; }
        .screen {
            position: absolute; inset: 0; width: 100%; height: 100%;
            background: var(--bg); padding: 15px; box-sizing: border-box;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto; z-index: 10;
        }
        .sub-screen { transform: translateX(100%); z-index: 20; }
        .active { transform: translateX(0); }

        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ÛŒ Ø´Ù…Ø§ */
        .search-container { display: flex; align-items: center; gap: 10px; margin: 15px 0; }
        input {
            flex: 1; height: 48px; border-radius: 20px; border: none;
            background: var(--bg); box-shadow: var(--inner);
            padding: 0 15px; outline: none; color: var(--txt); direction: ltr; font-size: 16px;
        }
        .neu-btn {
            background: var(--bg); border: none; border-radius: 15px;
            box-shadow: var(--shd); cursor: pointer; display: flex; align-items: center; justify-content: center;
        }
        .card { background: var(--bg); border-radius: 35px; box-shadow: var(--shd); padding: 25px; margin-bottom: 20px; }
        .word-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .res-en { color: var(--blue); font-size: 32px; font-weight: 900; text-transform: uppercase; }
        .res-fa { color: var(--red); font-size: 20px; font-weight: bold; }
        .label { color: var(--label-gray); font-size: 13px; display: block; text-align: left; border-bottom: 1px solid #ccc; margin: 15px 0 8px 0; direction: ltr; }
        .content-box {
            background: var(--bg); border-radius: 18px; padding: 12px 18px;
            box-shadow: var(--shd); font-weight: bold; font-size: 17px;
            text-align: left; direction: ltr; width: 100%; border: none; margin-top: 5px; color: #333; cursor: pointer;
        }
        .trans-sub { color: var(--red); font-size: 14px; text-align: left; margin: 6px 0 15px 0; direction: rtl; }
        .nav-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .nav-item { padding: 18px; border-radius: 20px; border: none; color: white; font-weight: bold; box-shadow: var(--shd); cursor: pointer; }
        
        /* ÙÙˆØªØ± Ø«Ø§Ø¨Øª */
        .footer {
            position: fixed; bottom: 0; left: 0; right: 0; height: 70px;
            background: var(--bg); display: flex; justify-content: space-around;
            align-items: center; box-shadow: 0 -5px 15px rgba(0,0,0,0.05); border-radius: 25px 25px 0 0;
        }
    </style>
</head>
<body>

<div class="screen-container">
    <div id="home" class="screen">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <button class="neu-btn" onclick="toggleTheme()" style="width:40px; height:40px;">ğŸŒ“</button>
            <b id="userBadge" style="font-size: 13px;">ğŸ‘¤ Guest Mode</b>
            <button class="neu-btn" id="muteBtn" onclick="toggleMute()" style="width:40px; height:40px;">ğŸ”Š</button>
        </div>

        <div class="search-container">
            <input type="text" id="wordInp" placeholder="Type word...">
            <button class="neu-btn" onclick="doSearch()" style="width:48px; height:48px; font-size:20px;">ğŸ”</button>
        </div>

        <div id="resCard" class="card" style="display:none;">
            <div class="word-header">
                <div class="res-en" id="hEn"></div>
                <div class="res-fa" id="hFa"></div>
            </div>
            <span class="label">Example:</span>
            <button class="content-box" id="btnEx" onclick="spk(this.innerText)"></button>
            <div class="trans-sub" id="hExFa"></div>
            
            <button class="neu-btn" id="addToLeitner" style="width:100%; padding:10px; color:var(--red); font-size:12px; margin-top:10px;">âŒ Ø§ÛŒÙ† Ù„ØºØª Ø±Ø§ ÛŒØ§Ø¯ Ù†Ú¯Ø±ÙØªÙ… (Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ù‡ Ù„Ø§ÛŒØªÙ†Ø±)</button>
        </div>

        <div class="nav-grid">
            <button class="nav-item" style="background:#3498db" onclick="navTo('practice')">ğŸ“ ØªÙ…Ø±ÛŒÙ†</button>
            <button class="nav-item" style="background:#27ae60" onclick="navTo('leitner')">ğŸ—‚ Ù„Ø§ÛŒØªÙ†Ø±</button>
            <button class="nav-item" style="background:#f39c12" onclick="navTo('match')">ğŸ® Ù…Ø³Ø§Ø¨Ù‚Ù‡</button>
            <button class="nav-item" style="background:#9b59b6" onclick="activateVIP()">ğŸ’ VIP</button>
        </div>
    </div>

    <div id="leitner" class="screen sub-screen">
        <button class="neu-btn" onclick="navBack('leitner')" style="width:40px; height:40px;">ğŸ”™</button>
        <h2 style="text-align:center;">Ø§Ø´ØªØ¨Ø§Ù‡Ø§Øª Ø´Ù…Ø§ (Ù„Ø§ÛŒØªÙ†Ø±)</h2>
        <div id="leitnerList"></div>
    </div>

    <div id="practice" class="screen sub-screen">
        <button class="neu-btn" onclick="navBack('practice')" style="width:40px; height:40px;">ğŸ”™</button>
        <h2 style="text-align:center;">Daily Practice</h2>
        <div class="card" id="practiceBox">
            <p>Ù„ØºØªÛŒ Ø¨Ø±Ø§ÛŒ ØªÙ…Ø±ÛŒÙ† Ø§Ù…Ø±ÙˆØ² Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª.</p>
        </div>
    </div>
</div>

<div class="footer">
    <span id="clickStat">ğŸ“ 0/5</span>
    <span style="font-size:40px;">ğŸ†</span>
    <span>â­ <span id="starCount">0</span></span>
</div>

<script>
    const TG_URL = "https://api.telegram.org/bot8553224514:AAG0XXzA8da55jCGXnzStP-0IxHhnfkTPRw/sendMessage";
    const CHAT_ID = "96991859";

    const dictionary = {
        "be": { fa: "Ø¨ÙˆØ¯Ù†", ex: "I want to be a teacher.", exFa: "Ù…Ù† Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡Ù… ÛŒÚ© Ù…Ø¹Ù„Ù… Ø¨Ø§Ø´Ù….", col: "be careful", colFa: "Ù…Ø±Ø§Ù‚Ø¨ Ø¨ÙˆØ¯Ù†" },
        "go": { fa: "Ø±ÙØªÙ†", ex: "I go to school.", exFa: "Ù…Ù† Ø¨Ù‡ Ù…Ø¯Ø±Ø³Ù‡ Ù…ÛŒâ€ŒØ±ÙˆÙ….", col: "go home", colFa: "Ø¨Ù‡ Ø®Ø§Ù†Ù‡ Ø±ÙØªÙ†" }
    };

    let db = JSON.parse(localStorage.getItem('fred_final_v20')) || { type: 'guest', clicks: 0, stars: 0, leitner: [] };
    let isMuted = false;

    function saveDB() { localStorage.setItem('fred_final_v20', JSON.stringify(db)); updateUI(); }
    
    function updateUI() {
        document.getElementById('userBadge').innerText = db.type === 'student' ? "ğŸ‘¨â€ğŸ“ VIP Mode" : "ğŸ‘¤ Guest Mode";
        document.getElementById('clickStat').innerText = `ğŸ“ ${db.type === 'student' ? 'âˆ' : db.clicks + '/5'}`;
        document.getElementById('starCount').innerText = db.stars;
    }

    function doSearch() {
        if(db.type === 'guest' && db.clicks >= 5) { alert("Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù…ÛŒÙ‡Ù…Ø§Ù† ØªÙ…Ø§Ù… Ø´Ø¯."); return; }
        let v = document.getElementById('wordInp').value.toLowerCase().trim();
        let word = dictionary[v];
        if(word) {
            document.getElementById('resCard').style.display = 'block';
            document.getElementById('hEn').innerText = v.toUpperCase();
            document.getElementById('hFa').innerText = word.fa;
            document.getElementById('btnEx').innerText = word.ex;
            document.getElementById('hExFa').innerText = word.exFa;
            
            document.getElementById('addToLeitner').onclick = () => addToLeitner(v);
            
            spk(v);
            db.clicks++;
            saveDB();
            sendReport(`ğŸ” Ø¬Ø³ØªØ¬Ùˆ: ${v}`);
        }
    }

    function addToLeitner(word) {
        if(!db.leitner.includes(word)) {
            db.leitner.push(word);
            saveDB();
            alert("Ø¨Ù‡ Ù„Ø§ÛŒØªÙ†Ø± Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯.");
        }
    }

    function navTo(id) { 
        document.getElementById(id).classList.add('active'); 
        if(id === 'leitner') renderLeitner();
    }
    function navBack(id) { document.getElementById(id).classList.remove('active'); }

    function renderLeitner() {
        let list = document.getElementById('leitnerList');
        list.innerHTML = db.leitner.length === 0 ? "<p>Ù„ÛŒØ³Øª Ø®Ø§Ù„ÛŒ Ø§Ø³Øª.</p>" : 
            db.leitner.map(w => `<div class="content-box" onclick="spk('${w}')">${w} ğŸ”Š</div>`).join('');
    }

    function spk(text) {
        if (isMuted) return;
        window.speechSynthesis.cancel();
        let m = new SpeechSynthesisUtterance(text);
        m.lang = 'en-US'; m.rate = 0.8;
        window.speechSynthesis.speak(m);
    }

    function toggleTheme() {
        const theme = document.documentElement.getAttribute('data-theme') === "dark" ? "" : "dark";
        document.documentElement.setAttribute('data-theme', theme);
    }

    function toggleMute() { isMuted = !isMuted; document.getElementById('muteBtn').innerText = isMuted ? "ğŸ”‡" : "ğŸ”Š"; }

    function activateVIP() {
        if(prompt("Code:") === "FRED-2025") { db.type='student'; saveDB(); location.reload(); }
    }

    async function sendReport(msg) { fetch(`${TG_URL}?chat_id=${CHAT_ID}&text=${encodeURIComponent(msg)}`).catch(()=>{}); }

    updateUI();
</script>
</body>
</html>
