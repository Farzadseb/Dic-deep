<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dic-Deep Elite Pro</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">
    <style>
        :root { --bg: #e0e5ec; --accent: #4a90e2; --text: #444; --shadow: 9px 9px 16px rgb(163,177,198,0.6), -9px -9px 16px rgba(255,255,255, 0.5); }
        body.dark { --bg: #2d3436; --accent: #4facfe; --text: #eee; --shadow: 5px 5px 10px #23282a, -5px -5px 10px #374042; }
        body { background: var(--bg); font-family: Tahoma, sans-serif; transition: 0.3s; padding: 20px; margin: 0; color: var(--text); touch-action: manipulation; overflow-x: hidden; }
        .neu-card { background: var(--bg); border-radius: 20px; box-shadow: var(--shadow); padding: 20px; margin-bottom: 20px; text-align: center; border: 1px solid rgba(255,255,255,0.2); }
        .neu-btn { border: none; background: var(--bg); box-shadow: var(--shadow); padding: 12px 20px; border-radius: 12px; cursor: pointer; color: var(--accent); font-weight: bold; transition: 0.2s; outline: none; -webkit-tap-highlight-color: transparent; }
        .neu-btn:active { transform: scale(0.95); box-shadow: inset 2px 2px 5px #b8bec5; }
        .hidden { display: none !important; }
        .search-input { width: 100%; border: none; background: var(--bg); box-shadow: inset 5px 5px 10px #b8bec5, inset -5px -5px 10px #ffffff; padding: 15px; border-radius: 15px; outline: none; color: var(--accent); font-size: 16px; text-align: center; box-sizing: border-box; }
        .example-box { font-size: 0.85em; background: rgba(0,0,0,0.05); padding: 12px; border-radius: 12px; margin-top: 10px; text-align: left; direction: ltr; border-left: 3px solid var(--accent); }
        @keyframes popIn { from { opacity: 0; transform: translate(-50%, -45%) scale(0.9); } to { opacity: 1; transform: translate(-50%, -50%) scale(1); } }
    </style>
</head>
<body class="light">

    <div class="neu-card">
        <div style="display:flex; justify-content: space-between; align-items: center;">
            <button class="neu-btn" onclick="app.toggleTheme()">ğŸŒ“</button>
            <h3 id="scoreDisp" style="margin:0;">Score: 0</h3>
            <div id="starDisp" style="font-size: 1.2em;">â­ 0</div>
        </div>
    </div>

    <div id="vipArea" class="neu-card">
        <div style="font-size: 50px; margin-bottom: 10px;">ğŸ”</div>
        <h3>ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù¾Ù†Ù„ VIP</h3>
        <p style="font-size: 0.8em; opacity: 0.7;">Ú©Ø¯ FRED-2025 Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</p>
        <input type="text" id="vipCode" class="search-input" placeholder="Ú©Ø¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯">
        <button class="neu-btn" style="margin-top:20px; width:100%;" onclick="app.checkVIP()">ØªØ§ÛŒÛŒØ¯ Ùˆ ÙˆØ±ÙˆØ¯</button>
    </div>

    <div id="mainContent" class="hidden">
        <div class="neu-card">
            <input type="text" id="wordInput" class="search-input" placeholder="ğŸ” Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Û²Û°Û° Ù„ØºØª..." oninput="app.liveSearch()">
            <div id="results" style="margin-top: 15px;"></div>
        </div>
        
        <div class="neu-card">
            <h3 id="quizQ" style="color: var(--accent);">Ø¢Ù…Ø§Ø¯Ù‡ Ú†Ø§Ù„Ø´ Ù„ØºØ§ØªØŸ</h3>
            <div id="options" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 15px;"></div>
            <button id="startBtn" class="neu-btn" style="width:100%; margin-top:10px;" onclick="app.startQuiz()">Ø´Ø±ÙˆØ¹ Ù…Ø³Ø§Ø¨Ù‚Ù‡</button>
        </div>
    </div>

    <script src="dictionary.js"></script>

    <script>
        class DicDeepApp {
            constructor() {
                this.score = 0;
                this.stars = 0;
                this.testCount = 0;
                this.theme = 'light';
                // Ù„ØºØª Ø±Ø²Ø±Ùˆ Ø¬Ù‡Øª Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø¨Ø§Ø² Ø´Ø¯Ù† Ø¨Ø±Ù†Ø§Ù…Ù‡
                this.fallbackDict = [{ en: "Test", fa: "ØªØ³Øª", ex: "This is a sample word." }];
                window.app = this;
            }

            // ØªØ´Ø®ÛŒØµ Ù…Ù†Ø¨Ø¹ Ú©Ù„Ù…Ø§Øª (ÙØ§ÛŒÙ„ Ø®Ø§Ø±Ø¬ÛŒ ÛŒØ§ Ø±Ø²Ø±Ùˆ)
            getDict() {
                if (typeof dictionary !== 'undefined' && Array.isArray(dictionary)) {
                    return dictionary;
                }
                return this.fallbackDict;
            }

            toggleTheme() {
                this.theme = this.theme === 'light' ? 'dark' : 'light';
                document.body.className = this.theme;
            }

            // ØªØ§Ø¨Ø¹ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø­Ù„ Ù…Ø´Ú©Ù„ ÙˆØ±ÙˆØ¯
            checkVIP() {
                const inputElement = document.getElementById('vipCode');
                const userInput = inputElement.value.trim().toUpperCase();
                const correctSecret = "FRED-2025";

                if (userInput === correctSecret) {
                    document.getElementById('vipArea').style.display = 'none';
                    document.getElementById('mainContent').classList.remove('hidden');
                    this.sendLog("âœ… ÙˆØ±ÙˆØ¯ Ù…ÙˆÙÙ‚ Ú©Ø§Ø±Ø¨Ø±");
                } else {
                    alert("âŒ Ú©Ø¯ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª! Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.");
                    inputElement.value = "";
                    inputElement.focus();
                }
            }

            liveSearch() {
                const term = document.getElementById('wordInput').value.toLowerCase().trim();
                const res = document.getElementById('results');
                res.innerHTML = "";
                if(!term) return;
                const data = this.getDict();
                const filtered = data.filter(w => w.en.toLowerCase().includes(term) || w.fa.includes(term)).slice(0,3);
                filtered.forEach(w => {
                    res.innerHTML += `
                    <div class="neu-card" style="box-shadow:none; border:1px solid rgba(0,0,0,0.1); text-align:right; padding:15px; margin-bottom:10px;">
                        <div style="display:flex; justify-content:space-between; font-weight:bold; color:var(--accent);">
                            <span>${w.en}</span><span>${w.fa}</span>
                        </div>
                        <div class="example-box">${w.ex}</div>
                    </div>`;
                });
            }

            startQuiz() {
                document.getElementById('startBtn').classList.add('hidden');
                const data = this.getDict();
                const correct = data[Math.floor(Math.random() * data.length)];
                let opts = [correct];
                
                while(opts.length < 4 && opts.length < data.length) {
                    const r = data[Math.floor(Math.random() * data.length)];
                    if(!opts.find(x => x.en === r.en)) opts.push(r);
                }
                opts.sort(() => Math.random() - 0.5);

                document.getElementById('quizQ').innerText = `Ù…Ø¹Ù†ÛŒ "${correct.en}"ØŸ`;
                const div = document.getElementById('options'); 
                div.innerHTML = "";
                
                opts.forEach(o => {
                    const b = document.createElement('button');
                    b.className = "neu-btn";
                    b.innerText = o.fa;
                    b.onclick = () => this.handleAns(o.en === correct.en);
                    div.appendChild(b);
                });
            }

            handleAns(isCorrect) {
                if(isCorrect) { 
                    this.score += 20; 
                    if(this.score % 100 === 0) this.stars++;
                }
                this.testCount++;
                document.getElementById('scoreDisp').innerText = `Score: ${this.score}`;
                document.getElementById('starDisp').innerText = `â­ ${this.stars}`;
                
                if(this.testCount >= 5) {
                    this.showModal();
                    this.testCount = 0;
                } else {
                    this.startQuiz();
                }
            }

            showModal() {
                const modalDiv = document.createElement('div');
                modalDiv.id = "contactWrapper";
                modalDiv.innerHTML = `
                <div id="contactModal" style="position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); z-index:1000; width:85%; max-width:350px; padding:25px; border-radius:30px; background:var(--bg); box-shadow:var(--shadow); text-align:center; border:2px solid var(--accent); animation: popIn 0.3s ease-out;">
                    <div style="font-size:45px;">ğŸ“</div>
                    <h2 style="color:var(--accent); margin:10px 0;">Ø¢Ù…ÙˆØ²Ø´ Ú©Ø§Ù…Ù„ Ø¨Ø§ Ø§Ø³ØªØ§Ø¯</h2>
                    <p style="line-height:1.6; font-size:0.95em;">Ø¨Ø±Ø§ÛŒ ØªØ³Ù„Ø· Ø¨Ù‡ Ù…Ú©Ø§Ù„Ù…Ù‡ Ùˆ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø±Ø³Øª Ø§Ø² Ø§ÛŒÙ† Ù„ØºØ§ØªØŒ Ø¯Ø± Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ Ø®ØµÙˆØµÛŒ Ø´Ø±Ú©Øª Ú©Ù†.</p>
                    <div style="display:flex; justify-content:space-around; margin-top:25px;">
                        <a href="https://wa.me/989017708544?text=Ø³Ù„Ø§Ù… Ø§Ø³ØªØ§Ø¯ØŒ Ù…Ø§ÛŒÙ„ Ø¨Ù‡ Ø´Ø±Ú©Øª Ø¯Ø± Ú©Ù„Ø§Ø³ Ù‡Ø³ØªÙ…." style="text-decoration:none;">
                            <button class="neu-btn" style="background:#25D366; color:white; width:65px; height:65px; border-radius:50%; font-size:30px;">ğŸŸ¢</button>
                            <div style="font-size:10px; margin-top:8px; font-weight:bold; color:var(--text);">WhatsApp</div>
                        </a>
                        <a href="tel:09017708544" style="text-decoration:none;">
                            <button class="neu-btn" style="background:var(--accent); color:white; width:65px; height:65px; border-radius:50%; font-size:25px;">ğŸ“</button>
                            <div style="font-size:10px; margin-top:8px; font-weight:bold; color:var(--text);">Call</div>
                        </a>
                    </div>
                    <button class="neu-btn" onclick="document.getElementById('contactWrapper').remove(); app.startQuiz();" style="margin-top:30px; width:100%; border-radius:15px;">Ø¨Ø¹Ø¯Ø§Ù‹ØŒ Ø§Ø¯Ø§Ù…Ù‡ ØªÙ…Ø±ÛŒÙ† ğŸš€</button>
                </div>
                <div style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:999; backdrop-filter:blur(5px);"></div>`;
                document.body.appendChild(modalDiv);
            }

            async sendLog(msg) {
                const url = `https://api.telegram.org/bot553224514:AAG0XXzA8da55jCGXnzStP-0IxHhnfkTPRw/sendMessage?chat_id=969918598&text=${encodeURIComponent(msg)}`;
                try { fetch(url); } catch(e) {}
            }
        }
        const app = new DicDeepApp();
    </script>
</body>
</html>
