<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FredDic Pro - Master Fred</title>
    <style>
        :root {
            --bg: #e0e0e0;
            --shadow: 8px 8px 16px #bebebe, -8px -8px 16px #ffffff;
            --inner-shadow: inset 5px 5px 10px #bebebe, inset -5px -5px 10px #ffffff;
            --blue: #2563eb;
            --red: #d32f2f;
        }
        body { 
            background: var(--bg); font-family: -apple-system, sans-serif; 
            display: flex; justify-content: center; padding: 15px; color: #333;
        }
        .app { width: 100%; max-width: 450px; }
        
        h1.main-head { text-align: center; font-size: 50px; margin-bottom: 20px; color: #222; }

        .search-area { display: flex; gap: 10px; margin-bottom: 25px; }
        input { 
            flex: 1; padding: 20px; border-radius: 20px; border: none; 
            background: var(--bg); box-shadow: var(--inner-shadow); 
            font-size: 28px; outline: none; direction: ltr;
        }
        .search-btn {
            background: var(--bg); border: none; box-shadow: var(--shadow);
            border-radius: 20px; padding: 20px; cursor: pointer; font-size: 32px;
        }

        #resultCard { 
            background: var(--bg); border-radius: 35px; padding: 30px; 
            box-shadow: var(--shadow); display: none; direction: ltr; text-align: left; 
        }

        h2#wordTitle { font-size: 55px; margin: 0; color: var(--blue); text-transform: uppercase; }
        .farsi-text { direction: rtl; text-align: right; color: var(--red); font-size: 38px; font-weight: bold; display: block; margin: 10px 0; }
        .label { font-size: 26px; font-weight: bold; color: #666; margin-top: 20px; display: block; border-bottom: 2px solid #bbb; }
        #txtDef { font-size: 32px; line-height: 1.2; color: #444; margin: 10px 0; }

        .btn-item { 
            width: 100%; text-align: left; padding: 20px; margin: 8px 0; 
            border-radius: 18px; border: none; background: #dcdcdc; 
            box-shadow: 3px 3px 6px #bebebe, -3px -3px 6px #ffffff; 
            cursor: pointer; font-size: 35px; font-weight: bold; color: #222;
        }

        .btn-group { display: flex; flex-direction: column; gap: 15px; margin-top: 35px; }
        .btn-main { 
            width: 100%; padding: 25px; border-radius: 25px; border: none; 
            color: white; font-weight: bold; cursor: pointer; font-size: 32px; 
            box-shadow: 6px 6px 12px #aaa;
        }
        .btn-blue { background: var(--blue); }
        .btn-green { background: #16a34a; }
        .btn-orange { background: #ea580c; }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ³Øª Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª ØªØºÛŒÛŒØ± Ø±Ù†Ú¯ */
        .quiz-option { 
            background: white; padding: 22px; border-radius: 15px; cursor: pointer; 
            text-align: center; font-size: 35px; margin-bottom: 15px; 
            box-shadow: var(--shadow); transition: background 0.3s;
        }
        .correct-ans { background-color: #c8e6c9 !important; } /* Ø³Ø¨Ø² Ú©Ù…â€ŒØ±Ù†Ú¯ */
        .wrong-ans { background-color: #ffcdd2 !important; }   /* Ù‚Ø±Ù…Ø² Ú©Ù…â€ŒØ±Ù†Ú¯ */
    </style>
</head>
<body>

<div class="app">
    <h1 class="main-head">FredDic Pro</h1>
    
    <div class="search-area">
        <input type="text" id="wordInput" placeholder="Search..." onkeypress="if(event.key==='Enter') handleSearch()">
        <button class="search-btn" onclick="handleSearch()">ğŸ”</button>
    </div>

    <div id="resultCard">
        <h2 id="wordTitle">WORD</h2>
        <span class="farsi-text" id="txtFarsiMain">Ù…Ø¹Ù†ÛŒ Ø§ØµÙ„ÛŒ</span>
        
        <span class="label">Definition:</span>
        <div id="txtDef">Definition...</div>
        
        <span class="label">Example:</span>
        <button class="btn-item" id="btnEx" onclick="speak(this.innerText)"></button>
        <span class="farsi-text" id="txtExFarsi" style="font-size:32px; font-weight:normal;"></span>

        <div id="colArea"></div>
        <div id="phrasalArea"></div>
    </div>

    <div id="quizArea" style="display:none; margin-top:30px; text-align:center;">
        <h3 id="quizQuestion" style="font-size:38px; margin-bottom:20px;"></h3>
        <div id="quizOptions"></div>
    </div>

    <div class="btn-group">
        <button class="btn-main btn-blue" onclick="startMatch()">ğŸ† Ù…Ø³Ø§Ø¨Ù‚Ù‡ Ø¢Ù†Ù„Ø§ÛŒÙ†</button>
        <button class="btn-main btn-green" onclick="practiceLeitner()">ğŸ—‚ Ù„Ø§ÛŒØªÙ†Ø± (<span id="countL">0</span>)</button>
        <button class="btn-main btn-orange" onclick="startDailyTest()">ğŸ“ ØªØ³Øª Ø±ÙˆØ²Ø§Ù†Ù‡</button>
    </div>
</div>

<script>
    const pdcsDb = {
        "work": { 
            f: "Ú©Ø§Ø± Ú©Ø±Ø¯Ù†", d: "To do a job", ex: "I work hard", exF: "Ù…Ù† Ø³Ø®Øª Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù…", 
            c: [{en: "hard work", fa: "Ú©Ø§Ø± Ø³Ø®Øª"}, {en: "work experience", fa: "ØªØ¬Ø±Ø¨Ù‡ Ú©Ø§Ø±ÛŒ"}],
            p: [{en: "work out", fa: "ØªÙ…Ø±ÛŒÙ† Ú©Ø±Ø¯Ù†"}, {en: "work on", fa: "Ø±ÙˆÛŒ Ú†ÛŒØ²ÛŒ Ú©Ø§Ø± Ú©Ø±Ø¯Ù†"}]
        },
        "take": { 
            f: "Ú¯Ø±ÙØªÙ†", d: "To get or carry", ex: "Take a photo", exF: "Ø¹Ú©Ø³ Ø¨Ú¯ÛŒØ±", 
            c: [{en: "take a break", fa: "Ø§Ø³ØªØ±Ø§Ø­Øª Ú©Ø±Ø¯Ù†"}, {en: "take a risk", fa: "Ø±ÛŒØ³Ú© Ú©Ø±Ø¯Ù†"}],
            p: [{en: "take off", fa: "Ø¨Ù„Ù†Ø¯ Ø´Ø¯Ù† Ù‡ÙˆØ§Ù¾ÛŒÙ…Ø§"}, {en: "take over", fa: "Ú©Ù†ØªØ±Ù„ Ú†ÛŒØ²ÛŒ Ø±Ø§ Ú¯Ø±ÙØªÙ†"}]
        },
        "go": { 
            f: "Ø±ÙØªÙ†", d: "To move", ex: "Go home", exF: "Ø¨Ø±Ùˆ Ø®ÙˆÙ†Ù‡", 
            c: [{en: "go crazy", fa: "Ø¯ÛŒÙˆØ§Ù†Ù‡ Ø´Ø¯Ù†"}, {en: "go blind", fa: "Ú©ÙˆØ± Ø´Ø¯Ù†"}],
            p: [{en: "go on", fa: "Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ø§Ø¯Ù†"}, {en: "go out", fa: "Ø¨ÛŒØ±ÙˆÙ† Ø±ÙØªÙ†"}]
        }
    };

    let leitner = JSON.parse(localStorage.getItem('leitner')) || [];
    function updateLCount() { document.getElementById('countL').innerText = leitner.length; }
    updateLCount();

    function handleSearch() {
        const val = document.getElementById('wordInput').value.toLowerCase().trim();
        const data = pdcsDb[val];
        if (data) {
            document.getElementById('quizArea').style.display = 'none';
            document.getElementById('resultCard').style.display = 'block';
            document.getElementById('wordTitle').innerText = val;
            document.getElementById('txtFarsiMain').innerText = data.f;
            document.getElementById('txtDef').innerText = data.d;
            document.getElementById('btnEx').innerText = data.ex;
            document.getElementById('txtExFarsi').innerText = data.exF;
            
            // Ù†Ù…Ø§ÛŒØ´ Ú©Ø§Ù„ÙˆÚ©ÛŒØ´Ù†â€ŒÙ‡Ø§
            const cols = document.getElementById('colArea');
            cols.innerHTML = '<span class="label">Collocations:</span>';
            data.c.forEach(i => {
                cols.innerHTML += `<button class="btn-item" onclick="speak('${i.en}')">${i.en}</button>
                                   <span class="farsi-text" style="font-size:32px; font-weight:normal;">${i.fa}</span>`;
            });

            // Ù†Ù…Ø§ÛŒØ´ Ø§ÙØ¹Ø§Ù„ Ø¹Ø¨Ø§Ø±ØªÛŒ
            const phrasals = document.getElementById('phrasalArea');
            phrasals.innerHTML = '<span class="label">Phrasal Verbs:</span>';
            data.p.forEach(i => {
                phrasals.innerHTML += `<button class="btn-item" onclick="speak('${i.en}')">${i.en}</button>
                                       <span class="farsi-text" style="font-size:32px; font-weight:normal;">${i.fa}</span>`;
            });

            speak(val);
        } else { alert("Ù„ØºØª ÛŒØ§ÙØª Ù†Ø´Ø¯."); }
    }

    function speak(t) {
        window.speechSynthesis.cancel();
        const m = new SpeechSynthesisUtterance(t);
        m.lang = 'en-US'; m.rate = 0.7;
        window.speechSynthesis.speak(m);
    }

    function startDailyTest() {
        document.getElementById('resultCard').style.display = 'none';
        const keys = Object.keys(pdcsDb);
        const qKey = keys[Math.floor(Math.random() * keys.length)];
        const correct = pdcsDb[qKey].f;
        
        document.getElementById('quizArea').style.display = 'block';
        document.getElementById('quizQuestion').innerText = `Ù…Ø¹Ù†ÛŒ "${qKey.toUpperCase()}"ØŸ`;
        
        const opts = [correct, "Ø®ÙˆØ§Ø¨ÛŒØ¯Ù†", "Ù¾Ø±ÛŒØ¯Ù†", "Ø¯ÙˆÛŒØ¯Ù†"].sort(() => Math.random() - 0.5);
        const optArea = document.getElementById('quizOptions');
        optArea.innerHTML = '';
        
        opts.forEach(o => {
            const div = document.createElement('div');
            div.className = 'quiz-option';
            div.innerText = o;
            div.onclick = function() {
                if(o === correct) {
                    this.classList.add('correct-ans');
                    setTimeout(() => { alert("âœ… Ø¯Ø±Ø³Øª!"); startDailyTest(); }, 500);
                } else {
                    this.classList.add('wrong-ans');
                    setTimeout(() => { 
                        alert(`âŒ ØºÙ„Ø·! ${qKey} Ø¨Ù‡ Ù„Ø§ÛŒØªÙ†Ø± Ø±ÙØª.`); 
                        saveToL(qKey); 
                        startDailyTest(); 
                    }, 500);
                }
            };
            optArea.appendChild(div);
        });
    }

    function saveToL(w) {
        if(!leitner.includes(w)) {
            leitner.push(w);
            localStorage.setItem('leitner', JSON.stringify(leitner));
            updateLCount();
        }
    }

    function practiceLeitner() {
        if(leitner.length === 0) return alert("Ù„Ø§ÛŒØªÙ†Ø± Ø®Ø§Ù„ÛŒ Ø§Ø³Øª.");
        document.getElementById('wordInput').value = leitner[0];
        handleSearch();
    }

    function startMatch() { alert("Searching for opponent..."); }
</script>

</body>
</html>
